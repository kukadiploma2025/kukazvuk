<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–£—á—ë—Ç –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/7.7.0/docx.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f3f4f6;
      margin: 0;
      padding: 20px;
    }
    .container {
      max-width: 900px;
      margin: auto;
      background: white;
      border-radius: 10px;
      padding: 30px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h2 {
      text-align: center;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    th {
      background: #e3e3e3;
    }
    button {
      padding: 10px 20px;
      border: none;
      background: #4CAF50;
      color: white;
      border-radius: 5px;
      cursor: pointer;
      display: block;
      margin: 20px auto;
    }
    button:hover {
      background: #45a049;
    }
  </style>
</head>
<body>

  <div class="container">
    <h2>–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</h2>
    <h3>1 –≥—Ä—É–ø–ø–∞</h3>
    <table id="group1"></table>

    <h3>2 –≥—Ä—É–ø–ø–∞</h3>
    <table id="group2"></table>

    <button id="downloadBtn">üì• –°–∫–∞—á–∞—Ç—å DOCX</button>
  </div>

  <script>
    const group1 = [
      "–ê–π–¥–æ—Å –ï—Ä–ª–∞–Ω–æ–≤", "–ê—Ä—É–∂–∞–Ω –°–∞–ø–∞—Ä–æ–≤–∞", "–ë–µ–∫–∑–∞—Ç –ù—É—Ä–ª–∞–Ω–æ–≤",
      "–ñ–∞–Ω–µ–ª—å –ö—É–∞—Ç–æ–≤–∞", "–ï—Ä–Ω–∞—Ä –¢–ª–µ—É–ª–∏–Ω", "–î–∏–∞—Å –ê—Ö–º–µ—Ç–æ–≤",
      "–ê—Å–µ–º–≥—É–ª—å –ú—É—Ä–∞—Ç–æ–≤–∞", "–†—É—Å–ª–∞–Ω –ö–∞–¥—ã—Ä", "–ê–ª–∏–Ω–∞ –ñ—É–º–∞–±–µ–∫",
      "–°–∞–º–∞—Ç –ö–æ–∂–∞—Ö–º–µ—Ç"
    ];

    const group2 = [
      "–ú–∞–¥–∏–Ω–∞ –ë–µ–π—Å–µ–Ω", "–¢–∏–º—É—Ä –†–∞—Ö–∏–º–æ–≤", "–ê—Ä—Å–µ–Ω –ö—É–∞–Ω—ã—à",
      "–ê—è—É–ª—ã–º –ñ–∞–∫—Å—ã–±–∞–µ–≤–∞", "–î–∞—É—Ä–µ–Ω –°–µ–∏—Ç–æ–≤", "–ö–∞—Ä–∏–Ω–∞ –¢–∞—Å—Ç–∞–Ω",
      "–ï—Ä–∞—Å—ã–ª –ù—É—Ä–≥–∞–ª–∏–µ–≤", "–ê–ª–∏–±–µ–∫ –¢–æ–ª–µ—É", "–ê–π–≥–µ—Ä–∏–º –ù–∏—è–∑–æ–≤–∞",
      "–ù—É—Ä–∏—Å–ª–∞–º –ê–±–¥—É–ª–ª–∞–µ–≤"
    ];

    function createTable(group, elementId) {
      const table = document.getElementById(elementId);
      const headerRow = document.createElement("tr");
      headerRow.innerHTML = "<th>‚Ññ</th><th>–ò–º—è —Å—Ç—É–¥–µ–Ω—Ç–∞</th><th>–ü—Ä–∏—Å—É—Ç—Å—Ç–≤–∏–µ</th>";
      table.appendChild(headerRow);

      group.forEach((name, index) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${index + 1}</td>
          <td>${name}</td>
          <td><input type="checkbox" class="presence"></td>
        `;
        table.appendChild(row);
      });
    }

    createTable(group1, "group1");
    createTable(group2, "group2");

    document.getElementById("downloadBtn").addEventListener("click", async () => {
      const { Document, Packer, Paragraph, TextRun, HeadingLevel, AlignmentType } = window.docx;

      const allTables = document.querySelectorAll("table");
      let content = [];

      allTables.forEach((table, i) => {
        const rows = Array.from(table.querySelectorAll("tr")).slice(1);
        content.push(new Paragraph({
          text: i === 0 ? "1 –≥—Ä—É–ø–ø–∞" : "2 –≥—Ä—É–ø–ø–∞",
          heading: HeadingLevel.HEADING_2
        }));

        rows.forEach((row, index) => {
          const name = row.cells[1].textContent;
          const present = row.cells[2].querySelector("input").checked ? "‚úÖ" : "‚ùå";
          content.push(new Paragraph(`${index + 1}. ${name} ‚Äî ${present}`));
        });

        content.push(new Paragraph(" "));
      });

      const doc = new Document({
        sections: [{
          properties: {},
          children: [
            new Paragraph({
              text: "–û—Ç—á—ë—Ç –ø–æ –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏",
              heading: HeadingLevel.TITLE,
              alignment: AlignmentType.CENTER
            }),
            new Paragraph(" "),
            ...content
          ]
        }]
      });

      const blob = await Packer.toBlob(doc);

      // üíæ —Å—Ç–∞–±–∏–ª—å–Ω–æ–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
      const a = document.createElement("a");
      const url = window.URL.createObjectURL(blob);
      a.href = url;
      a.download = "–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å.docx";
      document.body.appendChild(a);
      a.click();
      setTimeout(() => {
        document.body.removeChild(a);
        window.URL.revokeObjectURL(url);
      }, 1000);
    });
  </script>
</body>
</html>
