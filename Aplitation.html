<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–£—á—ë—Ç –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏</title>
<style>
    body {
        font-family: "Segoe UI", sans-serif;
        background: linear-gradient(135deg, #0a0a0a, #1a1a1a);
        color: #fff;
        margin: 0;
        padding: 0;
        text-align: center;
    }
    .login-container {
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        height: 100vh;
    }
    .login-box {
        background: #151515;
        border: 1px solid #2b2b2b;
        padding: 40px;
        border-radius: 12px;
        box-shadow: 0 0 25px rgba(0,255,198,0.1);
    }
    input {
        margin: 10px 0;
        padding: 12px;
        width: 220px;
        border: none;
        border-radius: 8px;
        outline: none;
        background: #1f1f1f;
        color: #fff;
        text-align: center;
    }
    input:focus { box-shadow: 0 0 10px #00ffc6; }
    button {
        margin-top: 15px;
        background: #00ffc6;
        color: #000;
        font-weight: bold;
        padding: 12px 25px;
        border: none;
        border-radius: 10px;
        cursor: pointer;
        transition: 0.3s;
        box-shadow: 0 0 15px #00ffc6;
    }
    button:hover {
        transform: scale(1.05);
        box-shadow: 0 0 25px #00ffc6;
    }
    #error { color: #ff4f6d; margin-top: 10px; font-size: 14px; }
    .hidden { display: none; }
    .group-container {
        display: flex;
        justify-content: center;
        flex-wrap: wrap;
        gap: 25px;
        margin: 20px;
    }
    .group {
        background: #181818;
        border: 1px solid #2b2b2b;
        border-radius: 12px;
        padding: 20px;
        width: 360px;
        box-shadow: 0 0 20px rgba(0,255,198,0.1);
    }
    h1 {
        color: #00ffc6;
        text-shadow: 0 0 10px #00ffc6;
        margin-top: 20px;
    }
    h2 {
        color: #00ffc6;
        font-size: 20px;
        border-bottom: 1px solid #00ffc6;
        padding-bottom: 6px;
        margin-bottom: 10px;
    }
    table {
        width: 100%;
        border-collapse: collapse;
        color: #ddd;
    }
    td {
        padding: 6px;
        border-bottom: 1px solid #2a2a2a;
        text-align: left;
    }
    input[type="checkbox"] {
        transform: scale(1.2);
        accent-color: #00ffc6;
        cursor: pointer;
    }
    tr.present { background: rgba(0, 255, 198, 0.15); }
    tr.absent { background: rgba(255, 0, 70, 0.15); }
</style>
</head>
<body>

<!-- üîê –í—Ö–æ–¥ -->
<div class="login-container" id="loginPage">
    <div class="login-box">
        <h1>–í—Ö–æ–¥ –≤ —Å–∏—Å—Ç–µ–º—É</h1>
        <input id="username" placeholder="–õ–æ–≥–∏–Ω">
        <input id="password" type="password" placeholder="–ü–∞—Ä–æ–ª—å">
        <button onclick="login()">–í–æ–π—Ç–∏</button>
        <div id="error"></div>
    </div>
</div>

<!-- üìã –ì–ª–∞–≤–Ω–∞—è -->
<div class="hidden" id="mainPage">
    <h1>–£—á—ë—Ç –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏</h1>
    <p>–û–ü 6B06102 ‚Äì ¬´–í—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–∞—è —Ç–µ—Ö–Ω–∏–∫–∞ –∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ¬ª<br>
    –ì—Ä—É–ø–ø–∞ –ë –í–¢–∏–ü–û-25/23 –† | –î–∞—Ç–∞: <span id="date"></span></p>

    <div class="group-container">
        <div class="group">
            <h2>1 –ø–æ–¥–≥—Ä—É–ø–ø–∞</h2>
            <table id="table1"></table>
        </div>
        <div class="group">
            <h2>2 –ø–æ–¥–≥—Ä—É–ø–ø–∞</h2>
            <table id="table2"></table>
        </div>
    </div>
    <button onclick="downloadDoc()">üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ DOCX</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/docx@8.0.0/build/index.umd.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>

<script>
const users = {
    "Kukandrio": "7890",
    "Asanali": "1423",
    "ZamSt": "2233"
};

function login() {
    const user = document.getElementById("username").value.trim();
    const pass = document.getElementById("password").value.trim();
    const error = document.getElementById("error");
    if (users[user] && users[user] === pass) {
        document.getElementById("loginPage").classList.add("hidden");
        document.getElementById("mainPage").classList.remove("hidden");
    } else {
        error.textContent = "–ù–µ–≤–µ—Ä–Ω—ã–π –ª–æ–≥–∏–Ω –∏–ª–∏ –ø–∞—Ä–æ–ª—å ‚ùå";
    }
}

const group1 = [
    "–ê–±–µ–Ω–æ–≤ –†–∞—Å—É–ª—Ö–∞–Ω –ï–ª–µ—É–±–∞–µ–≤–∏—á","–ê–±–∏–ª—å–≥–∞–∑–∏–µ–≤ –¢–∞–≥–∏—Ä –ë–∞–ª—Ç–∞–±–∞–µ–≤–∏—á","–ê–∫–∞–Ω–æ–≤ –ë–∏—Ä–∂–∞–Ω –ë–µ–π–±–∏—Ç–æ–≤–∏—á",
    "–ê—Å–∞–Ω –ë–µ–∫—Å—É–ª—Ç–∞–Ω –ê–ª—å–±–µ–∫—É–ª—ã","–ê—Å–∞–Ω—Ö–∞–Ω–æ–≤ “ö–∞—Å—ã–º–∂–æ–º–∞—Ä—Ç –ï—Ä–∂–∞–Ω“±–ª—ã","–ë–∞—Ä–∞–±–∞–Ω –ú–∞–∫—Å–∏–º –ê–Ω–¥—Ä–µ–µ–≤–∏—á",
    "–ë–æ–¥—ã–∫–æ–≤ –ê–ª–¥–∏—è—Ä –ï—Ä–±—É–ª–∞–Ω–æ–≤–∏—á","–ë—É—Ä—è–∫–æ–≤ –ú–∞—Ç–≤–µ–π –ï–≤–≥–µ–Ω–∏–µ–≤–∏—á","–ë–µ–∫–µ–Ω –ú–∞“ì–∂–∞–Ω –ï–¥—ñ–ª“±–ª—ã",
    "–ì–∞–¥–∞–º—É—Ä–æ–≤ –ë–µ–∫—Ö–∞–Ω –†—É—Å—Ç–∞–º–æ–≤–∏—á","–ì–∞–ª–∏–º—É–ª–ª–∏–Ω –ö–∞–º–∏–ª—å –†–∞—É–ª—å–µ–≤–∏—á","–ï—Ä–¥–µ–Ω –ê—Å–∞–Ω–∞–ª–∏ –ï—Ä–∂–∞–Ω“±–ª—ã",
    "–ñ–∞–∫–∏—è–Ω–æ–≤ –ê–º–∏—Ä –ú–∞—Ä–∞—Ç–æ–≤–∏—á","–ñ–∞–Ω—Ç–æ—Ä–∏–Ω –°–∞—è–Ω –°–µ—Ä–∏–∫–æ–≤–∏—á","–ñ—É–º–∞–¥–∏–ª–æ–≤ –ò–ª—å—è—Å –°–∞–∫–µ–Ω—É–ª—ã",
    "–ó–∞–π–∫–µ–Ω ”ò–¥—ñ–ª–µ—Ç –ù—É—Ä–ª–∞–Ω“±–ª—ã","–ò–≥–Ω–∞—Ç–µ–Ω–∫–æ –ê—Ä—Ç–µ–º –ê–ª–µ–∫—Å–µ–µ–≤–∏—á","–ö–∞–∏—ã–ø–æ–≤ –ù—É—Ä—Å—É–ª—Ç–∞–Ω –ú–∞—Ä—Å–æ–≤–∏—á",
    "–ö–∞—Ä–∞–æ—Å–º–∞–Ω–æ–≤ –ò—Å–ª–∞–º –•—É—Å–µ–π–Ω–æ–≤–∏—á","–ö–∏–∑–∞–µ–≤ –ê–ª–∞–Ω –ú–∞–∫—Å–∞—Ç–æ–≤–∏—á","–ö–æ–≤–∞–ª–µ–≤ –°–µ—Ä–≥–µ–π –í–ª–∞–¥–∏—Å–ª–∞–≤–æ–≤–∏—á",
    "–ö–æ–∑—è–∫–æ–≤ –í–ª–∞–¥–∏—Å–ª–∞–≤ –î–º–∏—Ç—Ä–∏–µ–≤–∏—á","–ö—É–¥–∞–π–±–µ—Ä–≥–µ–Ω–æ–≤ –¢–µ–º–∏—Ä–ª–∞–Ω –ú—É—Ä–∞—Ç–æ–≤–∏—á","–ö—É–∑—å–º–µ–Ω–∫–æ –í–∞–¥–∏–º –ì–µ–æ—Ä–≥–∏–µ–≤–∏—á"
];

const group2 = [
    "“ö–∞–±–¥—Ä–∞—à–∏—Ç –ù“±—Ä–∞—Å—ã–ª –ú“±—Ä–∞—Ç“±–ª—ã","“ö–∞–∏—Ä–±–∞–π ”ò–º—ñ—Ä –ú–∞“õ—Å“±—Ç“±–ª—ã","“ö–∞–ª–º–∞–Ω–±–∞–π –ê–ª–∏—Ö–∞–Ω –ê–±–∏–ª–¥–∞“±–ª—ã",
    "“ö—É–∞–Ω—Ç–∞–π –ï—Ä–ª–∞–Ω –ï—Ä“õ–∞–Ω–∞—Ç“±–ª—ã","–õ–∞—Ç–∏—Ñ–æ–≤ –ò—Å–ª–∞–º –ò—Ö—Ç–∏—è—Ä–æ–≤–∏—á","–ú–æ–∏—Å–µ–µ–≤ –í—è—á–µ—Å–ª–∞–≤ –ï–≤–≥–µ–Ω—å–µ–≤–∏—á",
    "–ú—É—Ä–∞—Ç–æ–≤ –ú–∞“õ—Å–∞—Ç –ú–∞—Ä–∞—Ç–æ–≤–∏—á","–ú—É—Ö—Ç–∞—Ä–æ–≤ –ê–ª–∏–±–µ–∫ –ê–∑–∞–º–∞—Ç–æ–≤–∏—á","–û—Ä—É–Ω–±–∞—Å–∞—Ä –ï—Ä–∞—Å—ã–ª –•–∞–º–∏—Ç“±–ª—ã",
    "–ü–µ—Ç—Ä—É—Å—å –ù–∞–∏–ª—å –ï—Å–∫–µ–Ω–¥–µ—Ä–æ–≤–∏—á","–ü—Ä–æ–∫–æ—Ñ—å–µ–≤ –î–∞–≤–∏–¥ –í–∏—Ç–∞–ª—å–µ–≤–∏—á","–°–∞–≥–∏—Ç–æ–≤ –°—É–ª—Ç–∞–Ω –°–∞–≥–∞—Ç–æ–≤–∏—á",
    "–°–∞–ª–∫–µ–Ω –î–∏–∞—Å –ú–∞–¥–∏“±–ª—ã","–°–∞–ø–∏–Ω–æ–≤ ”ò–¥—ñ–ª –ù“±—Ä–º–∞—Ö–∞–º–∞—Ç“±–ª—ã","–°–µ—Ä—ñ–∫ –ë–∞“õ“õ–∞–ª–∏ –ë–µ–π—Å–µ–Ω–±–µ–∫“±–ª—ã",
    "–°–µ—Ä–∏–∫–æ–≤–∞ –ê–Ω–µ–ª—è –ö–∞–Ω–∞—Ç–æ–≤–Ω–∞","–°–∏–Ω–µ–ª—å–Ω–∏–∫–æ–≤ –ê—Ä—Ç—É—Ä –ù–∏–∫–æ–ª–∞–µ–≤–∏—á","–°—ã—á—ë–≤ –°–µ—Ä–≥–µ–π –í–∏—Ç–∞–ª—å–µ–≤–∏—á",
    "–¢–µ–º–∏—Ä–±–∞–µ–≤ –ê–±—ã–ª–∞–π—Ö–∞–Ω –ê–¥–∏–ª—å–µ–≤–∏—á","–¢–∏–ª–µ—É“õ–∞–±—ã–ª –ê–ª–∏—Ö–∞–Ω –ï—Ä–±–æ–ª–∞—Ç“±–ª—ã","–¢–ª–µ–ø–±–µ—Ä–≥–µ–Ω “ö—É–∞–Ω—ã—à –ú“±—Ö–∏—Ç“±–ª—ã",
    "–•–∞—á–∞—Ç—Ä—è–Ω –ê—Ä—Ç—É—Ä –ì–∞–π–∫–æ–≤–∏—á","–†–∞—Ö–º–µ—Ç–æ–≤ –ú“±—Ö–∞–º–º–µ–¥ –£–º–±–µ—Ç“õ“±–ª“±–ª—ã","–ê–π–∫–µ–µ–≤ –¢–ª–µ—É—Ö–∞–Ω –¢—É–ª–µ–≥–µ–Ω–æ–≤–∏—á",
    "–®–∞–∫–∞–Ω–æ–≤ –ê–±–∏–ª—å–º–∞–Ω—Å—É—Ä –ê–ª–ø–∞–º—ã—Å–æ–≤–∏—á","–®—É–Ω–∫–æ–≤ –≠–º–∏—Ä –ú–∞–∫—Å–∞—Ç–æ–≤–∏—á"
];

function createTable(group, id) {
    const table = document.getElementById(id);
    group.forEach((name, index) => {
        const row = document.createElement("tr");
        row.innerHTML = `<td>${index + 1}</td><td>${name}</td>
                         <td><input type="checkbox"></td>`;
        table.appendChild(row);
        const box = row.querySelector("input");
        box.addEventListener("change", () => {
            row.className = box.checked ? "present" : "absent";
        });
    });
}
createTable(group1, "table1");
createTable(group2, "table2");

document.getElementById("date").textContent = new Date().toLocaleDateString("ru-RU");

async function downloadDoc() {
    const { Document, Packer, Paragraph } = docx;

    const children = [new Paragraph({ text: "–£—á—ë—Ç –ø–æ—Å–µ—â–∞–µ–º–æ—Å—Ç–∏", heading: "Heading1" })];
    children.push(new Paragraph({ text: `–î–∞—Ç–∞: ${new Date().toLocaleDateString("ru-RU")}`, spacing: { after: 400 } }));

    [group1, group2].forEach((group, i) => {
        children.push(new Paragraph({ text: `–ü–æ–¥–≥—Ä—É–ø–ø–∞ ${i + 1}`, spacing: { after: 200 } }));
        group.forEach((name, index) => {
            const tr = document.querySelectorAll(`#table${i + 1} tr`)[index];
            const checked = tr.querySelector("input").checked;
            const status = checked ? "‚úÖ –ü—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç" : "‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç";
            children.push(new Paragraph({ text: `${index + 1}. ${name} ‚Äî ${status}` }));
        });
        children.push(new Paragraph({ text: "" }));
    });

    const doc = new Document({ sections: [{ children }] });
    const blob = await Packer.toBlob(doc);

    saveAs(blob, `–ü–æ—Å–µ—â–∞–µ–º–æ—Å—Ç—å_${new Date().toLocaleDateString("ru-RU")}.docx`);
}
</script>
</body>
</html>
