<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>Учёт посещаемости</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/docx/8.0.0/docx.umd.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f3f4f6;
      margin: 0;
      padding: 20px;
    }
    .container {
      max-width: 900px;
      margin: auto;
      background: white;
      border-radius: 10px;
      padding: 30px;
      box-shadow: 0 0 10px rgba(0,0,0,0.1);
    }
    h2 {
      text-align: center;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
    }
    th {
      background: #e3e3e3;
    }
    button {
      padding: 10px 20px;
      border: none;
      background: #4CAF50;
      color: white;
      border-radius: 5px;
      cursor: pointer;
      display: block;
      margin: 20px auto;
    }
    button:hover {
      background: #45a049;
    }
  </style>
</head>
<body>

  <div class="container">
    <h2>Посещаемость студентов</h2>
    <h3>1 группа</h3>
    <table id="group1"></table>

    <h3>2 группа</h3>
    <table id="group2"></table>

    <button id="downloadBtn">Скачать DOCX</button>
  </div>

  <script>
    const group1 = [
      "Айдос Ерланов", "Аружан Сапарова", "Бекзат Нурланов",
      "Жанель Куатова", "Ернар Тлеулин", "Диас Ахметов",
      "Асемгуль Муратова", "Руслан Кадыр", "Алина Жумабек",
      "Самат Кожахмет"
    ];

    const group2 = [
      "Мадина Бейсен", "Тимур Рахимов", "Арсен Куаныш",
      "Аяулым Жаксыбаева", "Даурен Сеитов", "Карина Тастан",
      "Ерасыл Нургалиев", "Алибек Толеу", "Айгерим Ниязова",
      "Нурислам Абдуллаев"
    ];

    function createTable(group, elementId) {
      const table = document.getElementById(elementId);
      const headerRow = document.createElement("tr");
      headerRow.innerHTML = "<th>№</th><th>Имя студента</th><th>Присутствие</th>";
      table.appendChild(headerRow);

      group.forEach((name, index) => {
        const row = document.createElement("tr");
        row.innerHTML = `
          <td>${index + 1}</td>
          <td>${name}</td>
          <td><input type="checkbox" class="presence"></td>
        `;
        table.appendChild(row);
      });
    }

    createTable(group1, "group1");
    createTable(group2, "group2");

    document.getElementById("downloadBtn").addEventListener("click", async () => {
      const allTables = document.querySelectorAll("table");
      let content = [];

      allTables.forEach((table, i) => {
        const rows = Array.from(table.querySelectorAll("tr")).slice(1);
        content.push(new docx.Paragraph({
          text: i === 0 ? "1 группа" : "2 группа",
          heading: docx.HeadingLevel.HEADING_2
        }));

        rows.forEach((row, index) => {
          const name = row.cells[1].textContent;
          const present = row.cells[2].querySelector("input").checked ? "✅" : "❌";
          content.push(new docx.Paragraph(`${index + 1}. ${name} — ${present}`));
        });

        content.push(new docx.Paragraph(" "));
      });

      const doc = new docx.Document({
        sections: [{
          properties: {},
          children: [
            new docx.Paragraph({
              text: "Отчёт по посещаемости",
              heading: docx.HeadingLevel.TITLE,
              alignment: docx.AlignmentType.CENTER
            }),
            new docx.Paragraph(" "),
            ...content
          ]
        }]
      });

      const blob = await docx.Packer.toBlob(doc);
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "Посещаемость.docx";
      link.click();
    });
  </script>
</body>
</html>
